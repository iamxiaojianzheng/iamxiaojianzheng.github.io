<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"xiaojianzheng.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.8.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script><meta name="description" content="Collection &amp; Reuse"><meta property="og:type" content="website"><meta property="og:title" content="JIAHE"><meta property="og:url" content="http://xiaojianzheng.cn/page/2/index.html"><meta property="og:site_name" content="JIAHE"><meta property="og:description" content="Collection &amp; Reuse"><meta property="og:locale" content="zh_CN"><meta property="article:author" content="JIAHE"><meta property="article:tag" content="JIAHE"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://xiaojianzheng.cn/page/2/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/2/index.html","title":""}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>JIAHE</title><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><h1 class="site-title">JIAHE</h1><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-导航"><a href="/navigation/" rel="section"><i class="fa fa-location-arrow fa-fw"></i>导航</a></li><li class="menu-item menu-item-文档"><a href="/docs/" rel="section"><i class="fa fa-book fa-fw fa-fw"></i>文档</a></li><li class="menu-item menu-item-应用下载"><a href="/app-download/" rel="section"><i class="fas fa-download fa-fw fa-fw"></i>应用下载</a></li><li class="menu-item menu-item-cheat-sheet"><a href="/cheat-sheet/" rel="section"><i class="fas fa-pen fa-fw"></i>Cheat Sheet</a></li><li class="menu-item menu-item-软件安装部署"><a href="/software-install-and-deploy/" rel="section"><i class="fab fa-windows fa-fw"></i>软件安装部署</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-overview-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="JIAHE" src="/images/avatar.jpg"><p class="site-author-name" itemprop="name">JIAHE</p><div class="site-description" itemprop="description">Collection & Reuse</div></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">90</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">93</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-blogroll site-overview-item animated"><div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://cook.aiurs.co/" title="https:&#x2F;&#x2F;cook.aiurs.co&#x2F;" rel="noopener" target="_blank">程序员做饭指南</a></li><li class="links-of-blogroll-item"> <a href="https://www.baidu.com/" title="https:&#x2F;&#x2F;www.baidu.com&#x2F;" rel="noopener" target="_blank">Baidu</a></li><li class="links-of-blogroll-item"> <a href="https://cn.bing.com/" title="https:&#x2F;&#x2F;cn.bing.com&#x2F;" rel="noopener" target="_blank">Bing</a></li><li class="links-of-blogroll-item"> <a href="https://www.google.com/" title="https:&#x2F;&#x2F;www.google.com&#x2F;" rel="noopener" target="_blank">Google</a></li><li class="links-of-blogroll-item"> <a href="https://zh.wikipedia.org/wiki/Wikipedia:%E9%A6%96%E9%A1%B5" title="https:&#x2F;&#x2F;zh.wikipedia.org&#x2F;wiki&#x2F;Wikipedia:%E9%A6%96%E9%A1%B5" rel="noopener" target="_blank">Wiki</a></li><li class="links-of-blogroll-item"> <a href="https://projectlombok.org/" title="https:&#x2F;&#x2F;projectlombok.org&#x2F;" rel="noopener" target="_blank">lombok</a></li><li class="links-of-blogroll-item"> <a href="https://logging.apache.org/log4j/2.x/" title="https:&#x2F;&#x2F;logging.apache.org&#x2F;log4j&#x2F;2.x&#x2F;" rel="noopener" target="_blank">log4j</a></li><li class="links-of-blogroll-item"> <a href="http://logback.qos.ch/" title="http:&#x2F;&#x2F;logback.qos.ch&#x2F;" rel="noopener" target="_blank">logback</a></li><li class="links-of-blogroll-item"> <a href="https://junit.org/junit5/" title="https:&#x2F;&#x2F;junit.org&#x2F;junit5&#x2F;" rel="noopener" target="_blank">junit</a></li><li class="links-of-blogroll-item"> <a href="https://element.eleme.cn/#/zh-CN" title="https:&#x2F;&#x2F;element.eleme.cn&#x2F;#&#x2F;zh-CN" rel="noopener" target="_blank">ElementUI</a></li><li class="links-of-blogroll-item"> <a href="https://zipkin.io/" title="https:&#x2F;&#x2F;zipkin.io&#x2F;" rel="noopener" target="_blank">Zipkin</a></li><li class="links-of-blogroll-item"> <a href="https://www.selenium.dev/zh-cn/" title="https:&#x2F;&#x2F;www.selenium.dev&#x2F;zh-cn&#x2F;" rel="noopener" target="_blank">Selenium</a></li><li class="links-of-blogroll-item"> <a href="https://nacos.io/zh-cn/docs/what-is-nacos.html" title="https:&#x2F;&#x2F;nacos.io&#x2F;zh-cn&#x2F;docs&#x2F;what-is-nacos.html" rel="noopener" target="_blank">Nacos</a></li><li class="links-of-blogroll-item"> <a href="https://dev.mysql.com/downloads/" title="https:&#x2F;&#x2F;dev.mysql.com&#x2F;downloads&#x2F;" rel="noopener" target="_blank">MySQL-Download</a></li><li class="links-of-blogroll-item"> <a href="https://redis.io/" title="https:&#x2F;&#x2F;redis.io&#x2F;" rel="noopener" target="_blank">Redis</a></li><li class="links-of-blogroll-item"> <a href="https://www.jetbrains.com/help/idea/discover-intellij-idea.html" title="https:&#x2F;&#x2F;www.jetbrains.com&#x2F;help&#x2F;idea&#x2F;discover-intellij-idea.html" rel="noopener" target="_blank">IDEA-Document</a></li><li class="links-of-blogroll-item"> <a href="https://jdk.java.net/" title="https:&#x2F;&#x2F;jdk.java.net&#x2F;" rel="noopener" target="_blank">JDK</a></li><li class="links-of-blogroll-item"> <a href="https://www.java.com/en/download/manual.jsp" title="https:&#x2F;&#x2F;www.java.com&#x2F;en&#x2F;download&#x2F;manual.jsp" rel="noopener" target="_blank">JDK8</a></li><li class="links-of-blogroll-item"> <a href="https://dev.java/" title="https:&#x2F;&#x2F;dev.java&#x2F;" rel="noopener" target="_blank">JAVA</a></li><li class="links-of-blogroll-item"> <a href="https://www.oracle.com/java/technologies/downloads/archive/" title="https:&#x2F;&#x2F;www.oracle.com&#x2F;java&#x2F;technologies&#x2F;downloads&#x2F;archive&#x2F;" rel="noopener" target="_blank">JDK-Oracle</a></li><li class="links-of-blogroll-item"> <a href="https://poi.apache.org/components/index.html" title="https:&#x2F;&#x2F;poi.apache.org&#x2F;components&#x2F;index.html" rel="noopener" target="_blank">POI</a></li><li class="links-of-blogroll-item"> <a href="https://assertj.github.io/doc/" title="https:&#x2F;&#x2F;assertj.github.io&#x2F;doc&#x2F;" rel="noopener" target="_blank">AssertJ</a></li><li class="links-of-blogroll-item"> <a href="https://docshome.gitbook.io/nginx-docs/" title="https:&#x2F;&#x2F;docshome.gitbook.io&#x2F;nginx-docs&#x2F;" rel="noopener" target="_blank">Nginx-CN</a></li><li class="links-of-blogroll-item"> <a href="https://github.com/cglib/cglib" title="https:&#x2F;&#x2F;github.com&#x2F;cglib&#x2F;cglib" rel="noopener" target="_blank">cglib</a></li><li class="links-of-blogroll-item"> <a href="https://docs.gitlab.com/ee/api/api_resources.html" title="https:&#x2F;&#x2F;docs.gitlab.com&#x2F;ee&#x2F;api&#x2F;api_resources.html" rel="noopener" target="_blank">Gitlab Api</a></li></ul></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="返回顶部"><i class="fa fa-arrow-up"></i> <span>0%</span></div><a role="button" class="book-mark-link book-mark-link-fixed"></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner index posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang=""><link itemprop="mainEntityOfPage" href="http://xiaojianzheng.cn/2022/04/15/Kubernetes%E8%BF%90%E7%BB%B4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="JIAHE"><meta itemprop="description" content="Collection & Reuse"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="JIAHE"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a href="/2022/04/15/Kubernetes%E8%BF%90%E7%BB%B4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">Kubernetes 运维学习笔记</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-04-16 00:00:00" itemprop="dateCreated datePublished" datetime="2022-04-16T00:00:00+08:00">2022-04-16</time></span></div></div></header><div class="post-body" itemprop="articleBody"><blockquote><p>转载：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/kevingrace/p/5575666.html">https://www.cnblogs.com/kevingrace/p/5575666.html</a></p></blockquote><h1 id="一、Kubernetes-介绍"><a href="#一、Kubernetes-介绍" class="headerlink" title="一、Kubernetes 介绍"></a><strong>一、Kubernetes 介绍</strong></h1><p>Kubernetes是一个全新的基于容器技术的分布式架构领先方案, 它是Google在2014年6月开源的一个容器集群管理系统，使用Go语言开发，Kubernetes也叫K8S。K8S是Google内部一个叫Borg的容器集群管理系统衍生出来的，Borg已经在Google大规模生产运行十年之久。K8S主要用于自动化部署、扩展和管理容器应用，提供了资源调度、部署管理、服务发现、扩容缩容、监控等一整套功能。2015年7月，Kubernetes v1.0正式发布，截止到2017年9月29日最新稳定版本是v1.8。Kubernetes目标是让部署容器化应用简单高效。</p><p>Kubernetes最初源于谷歌内部的Borg，提供了面向应用的容器集群部署和管理系统。Kubernetes 的目标旨在消除编排物理/虚拟计算，网络和存储基础设施的负担，并使应用程序运营商和开发人员完全将重点放在以容器为中心的原语上进行自助运营。Kubernetes 也提供稳定、兼容的基础（平台），用于构建定制化的workflows 和更高级的自动化任务。</p><p>Kubernetes 具备完善的集群管理能力，包括多层次的安全防护和准入机制、多租户应用支撑能力、透明的服务注册和服务发现机制、内建负载均衡器、故障发现和自我修复能力、服务滚动升级和在线扩容、可扩展的资源自动调度机制、多粒度的资源配额管理能力。Kubernetes 还提供完善的管理工具，涵盖开发、部署测试、运维监控等各个环节。</p><div class="post-button"> <a class="btn" href="/2022/04/15/Kubernetes%E8%BF%90%E7%BB%B4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#more" rel="contents">阅读全文 &raquo;</a></div></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang=""><link itemprop="mainEntityOfPage" href="http://xiaojianzheng.cn/2021/11/07/2021-11-08-Slash-problem-when-reading-the-properties-file-in-Java/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="JIAHE"><meta itemprop="description" content="Collection & Reuse"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="JIAHE"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a href="/2021/11/07/2021-11-08-Slash-problem-when-reading-the-properties-file-in-Java/" class="post-title-link" itemprop="url">Properties中读取下划线的问题及解决办法</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-11-08 00:00:00" itemprop="dateCreated datePublished" datetime="2021-11-08T00:00:00+08:00">2021-11-08</time></span></div></div></header><div class="post-body" itemprop="articleBody"><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">BufferedReader reader = ResourceUtil.getUtf8Reader(<span class="string">&quot;xxx.properties&quot;</span>);</span><br><span class="line">Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">properties.load(reader);</span><br></pre></td></tr></table></figure><p>替换成这样</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">BufferedReader reader = ResourceUtil.getUtf8Reader(<span class="string">&quot;xxx.properties&quot;</span>);</span><br><span class="line">Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">properties.load(<span class="keyword">new</span> StringReader(IoUtil.read(reader).replace(<span class="string">&quot;\\&quot;</span>, <span class="string">&quot;\\\\&quot;</span>)));</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang=""><link itemprop="mainEntityOfPage" href="http://xiaojianzheng.cn/2021/11/05/2021-11-06-List-All-Classes-Loaded-in-a-Specific-Class-Loader/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="JIAHE"><meta itemprop="description" content="Collection & Reuse"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="JIAHE"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a href="/2021/11/05/2021-11-06-List-All-Classes-Loaded-in-a-Specific-Class-Loader/" class="post-title-link" itemprop="url">List All Classes Loaded in a Specific Class Loader</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-11-06 00:00:00" itemprop="dateCreated datePublished" datetime="2021-11-06T00:00:00+08:00">2021-11-06</time></span></div></div></header><div class="post-body" itemprop="articleBody"><div class="note info"><p>原文地址：<a target="_blank" rel="noopener" href="https://www.baeldung.com/java-list-classes-class-loader">https://www.baeldung.com/java-list-classes-class-loader</a></p></div><h2 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h2><p>In this tutorial, we&#39;ll analyze the technique <strong>to list all the classes loaded by a specific class loader</strong> in Java, using the <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-instrumentation">Java <em>Instrumentation</em> API</a>. We&#39;ll also see how to create and load a Java agent to acquire an <em>Instrumentation</em> instance and invoke the required methods to accomplish our task.</p><h2 id="2-Class-Loaders-in-Java"><a href="#2-Class-Loaders-in-Java" class="headerlink" title="2. Class Loaders in Java"></a>2. Class Loaders in Java</h2><p>The class loaders are an integral part of the JRE (Java Runtime Environment). Their job is to <strong>dynamically load classes into the Java Virtual Machine</strong>. In other words, they load classes into memory on-demand when required by the application. The article on <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-classloaders">Java class loaders</a> talks about their different types and provides a detailed understanding of how they work.</p><h2 id="3-Using-the-Instrumentation-API"><a href="#3-Using-the-Instrumentation-API" class="headerlink" title="3. Using the Instrumentation API"></a>3. Using the <em>Instrumentation API</em></h2><p>The <em>Instrumentation</em> interface provides the <em><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/14/docs/api/java.instrument/java/lang/instrument/Instrumentation.html#getInitiatedClasses(java.lang.ClassLoader)">getInitiatedClasses(Classloader loader)</a></em> method that can be <strong>invoked to</strong> <strong>return an array comprising all the classes loaded by the particular loader</strong>. Let&#39;s see how this works.</p><p>First, we need to create and load an agent to acquire an instance of the <em>Instrumentation</em> interface. A Java agent is a tool to instrument programs running on the JVM (Java Virtual Machine).</p><p>In other words, it can add or modify the bytecode of methods for the purpose of gathering data. We&#39;ll require an <em>agent</em> to get a handle on the <em>Instrumentation</em> instance and invoke the required method.</p><p>There are multiple ways to <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-instrumentation">create and load an agent</a>. In this tutorial, we&#39;ll use the static loading approach using the <em>premain</em> method and the <em>-javaagent</em> option.</p><h3 id="3-1-Creating-a-Java-Agent"><a href="#3-1-Creating-a-Java-Agent" class="headerlink" title="3.1. Creating a Java Agent"></a>3.1. Creating a Java Agent</h3><p>To create a Java agent, we need to <strong>define the premain method to which the Instrumentation instance will be passed on agent load</strong>. Let&#39;s now create the <em>ListLoadedClassesAgent</em> class:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListLoadedClassesAgent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Instrumentation instrumentation;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">premain</span><span class="params">(String agentArgs, Instrumentation instrumentation)</span> </span>&#123;</span><br><span class="line">        ListLoadedClassesAgent.instrumentation = instrumentation;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-Defining-the-listLoadedClasses-Methods"><a href="#3-2-Defining-the-listLoadedClasses-Methods" class="headerlink" title="3.2. Defining the listLoadedClasses Methods"></a>3.2. Defining the <em>listLoadedClasses</em> Methods</h3><p>In addition to defining the agent, we&#39;ll define and expose a static method to return an array of loaded classes for a given class loader.</p><p>Note that <strong>if we pass a class loader with a null value to the getInitiatedClasses method, it returns the classes loaded by the bootstrap class loader</strong>.</p><p>Let&#39;s see the code in action:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Class&lt;?&gt;[] listLoadedClasses(String classLoaderType) &#123;</span><br><span class="line">    <span class="keyword">return</span> instrumentation.getInitiatedClasses(</span><br><span class="line">      getClassLoader(classLoaderType));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ClassLoader <span class="title">getClassLoader</span><span class="params">(String classLoaderType)</span> </span>&#123;</span><br><span class="line">    ClassLoader classLoader = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">switch</span> (classLoaderType) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;SYSTEM&quot;</span>:</span><br><span class="line">            classLoader = ClassLoader.getSystemClassLoader();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;EXTENSION&quot;</span>:</span><br><span class="line">            classLoader = ClassLoader.getSystemClassLoader().getParent();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;BOOTSTRAP&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> classLoader;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Note that if we&#39;re using Java 9 or above, we can use the <em>getPlatformClassLoader</em> method. This will list the classes loaded by the Platform class loader. In that case, the switch case will also contain:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">&quot;PLATFORM&quot;</span>:</span><br><span class="line">    classLoader = ClassLoader.getPlatformClassLoader();</span><br><span class="line">    <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><h3 id="3-3-Creating-the-Agent-Manifest-File"><a href="#3-3-Creating-the-Agent-Manifest-File" class="headerlink" title="3.3. Creating the Agent Manifest File"></a>3.3. Creating the Agent Manifest File</h3><p>Now, let&#39;s create a manifest file, <em>MANIFEST.MF</em>, with appropriate attributes for our agent to run, including:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Premain-Class: com.baeldung.loadedclasslisting.ListLoadedClassesAgent</span><br></pre></td></tr></table></figure><p>The complete list of manifest attributes for an agent JAR file is available on the official documentation of the <em><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/14/docs/api/java.instrument/java/lang/instrument/package-summary.html">java.lang.instrument</a></em> package.</p><h3 id="3-4-Loading-the-Agent-and-Running-the-Application"><a href="#3-4-Loading-the-Agent-and-Running-the-Application" class="headerlink" title="3.4. Loading the Agent and Running the Application"></a>3.4. Loading the Agent and Running the Application</h3><p>Let&#39;s now load the agent and run the application. First, we need the agent JAR file with a manifest file containing the <em>Premain-Class</em> information. Additionally, we need the application JAR file with a manifest file containing the <em>Main-Class</em> information. The <em>Launcher class</em> containing the <em>main</em> method will start our application. Then we&#39;ll be able to print the classes loaded by different types of class loaders:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Launcher</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        printClassesLoadedBy(<span class="string">&quot;BOOTSTRAP&quot;</span>);</span><br><span class="line">        printClassesLoadedBy(<span class="string">&quot;SYSTEM&quot;</span>);</span><br><span class="line">        printClassesLoadedBy(<span class="string">&quot;EXTENSION&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printClassesLoadedBy</span><span class="params">(String classLoaderType)</span> </span>&#123;</span><br><span class="line">        System.out.println(classLoaderType + <span class="string">&quot; ClassLoader : &quot;</span>);</span><br><span class="line">        Class&lt;?&gt;[] classes = ListLoadedClassesAgent.listLoadedClasses(classLoaderType);</span><br><span class="line">        Arrays.asList(classes)</span><br><span class="line">            .forEach(clazz -&gt; System.out.println(clazz.getCanonicalName()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Next, let&#39;s statically <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-instrumentation#loading-a-java-agent">load the Java agent</a> and start our application:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java -javaagent:agent.jar -jar app.jar</span><br></pre></td></tr></table></figure><p>After running the above command, we&#39;ll see the output:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">BOOTSTRAP ClassLoader :</span><br><span class="line">java.lang.ClassValue.Entry[]</span><br><span class="line">java.util.concurrent.ConcurrentHashMap.Segment</span><br><span class="line">java.util.concurrent.ConcurrentHashMap.Segment[]</span><br><span class="line">java.util.StringTokenizer</span><br><span class="line">..............</span><br><span class="line">SYSTEM ClassLoader : </span><br><span class="line">java.lang.Object[]</span><br><span class="line">java.lang.Object[][]</span><br><span class="line">java.lang.Class</span><br><span class="line">java.lang.Class[]</span><br><span class="line">..............</span><br><span class="line">EXTENSION ClassLoader :</span><br><span class="line"><span class="keyword">byte</span>[]</span><br><span class="line"><span class="keyword">char</span>[]</span><br><span class="line"><span class="keyword">int</span>[]</span><br><span class="line"><span class="keyword">int</span>[][]</span><br><span class="line"><span class="keyword">short</span>[]</span><br></pre></td></tr></table></figure><h2 id="4-Conclusion"><a href="#4-Conclusion" class="headerlink" title="4. Conclusion"></a>4. Conclusion</h2><p>In this tutorial, we learned about the technique to list all the classes loaded in a specific class loader.</p><p>First, we created the Java Agent. After that, we defined the method to list the loaded classes using the Java <em>Instrumentation</em> API. Finally, we created the agent manifest files, loaded the agent, and ran our application.</p><p>As always, the complete source code of the example can be found <a target="_blank" rel="noopener" href="https://github.com/eugenp/tutorials/tree/master/core-java-modules/core-java-jvm-2">over on GitHub</a>.</p><p>Reference:</p><ul><li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/14/docs/api/java.instrument/java/lang/instrument/Instrumentation.html#getInitiatedClasses(java.lang.ClassLoader)">https://docs.oracle.com/en/java/javase/14/docs/api/java.instrument/java/lang/instrument/Instrumentation.html#getInitiatedClasses(java.lang.ClassLoader)</a></li><li><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/14/docs/api/java.instrument/java/lang/instrument/package-summary.html">https://docs.oracle.com/en/java/javase/14/docs/api/java.instrument/java/lang/instrument/package-summary.html</a></li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang=""><link itemprop="mainEntityOfPage" href="http://xiaojianzheng.cn/2021/10/29/2021-10-30-Life-Cycle-of-a-Thread-in-Java/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="JIAHE"><meta itemprop="description" content="Collection & Reuse"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="JIAHE"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a href="/2021/10/29/2021-10-30-Life-Cycle-of-a-Thread-in-Java/" class="post-title-link" itemprop="url">Life Cycle of a Thread in Java</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-10-30 00:00:00" itemprop="dateCreated datePublished" datetime="2021-10-30T00:00:00+08:00">2021-10-30</time></span></div></div></header><div class="post-body" itemprop="articleBody"><div class="note info"><p>原文地址：<a target="_blank" rel="noopener" href="https://www.baeldung.com/java-thread-lifecycle">https://www.baeldung.com/java-thread-lifecycle</a></p></div><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a><strong>1. Introduction</strong></h2><p>In this article, we&#39;ll discuss in detail a core concept in Java – the lifecycle of a thread.</p><p>We&#39;ll use a quick illustrated diagram and, of course, practical code snippets to better understand these states during the thread execution.</p><p>To get started understanding Threads in Java, <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-runnable-vs-extending-thread">this article</a> on creating a thread is a good place to start.</p><h2 id="2-Multithreading-in-Java"><a href="#2-Multithreading-in-Java" class="headerlink" title="2. Multithreading in Java"></a><strong>2. Multithreading in Java</strong></h2><p><strong>In the Java language, multithreading is driven by the core concept of a Thread</strong>. During their lifecycle, threads go through various states:</p><p><img data-src="https://cdn.jsdelivr.net/gh/xiao1272209235/hexo-image@main/16355829100901635582910076.png" alt="img">](<a target="_blank" rel="noopener" href="https://www.baeldung.com/wp-content/uploads/2018/02/Life_cycle_of_a_Thread_in_Java.jpg">https://www.baeldung.com/wp-content/uploads/2018/02/Life_cycle_of_a_Thread_in_Java.jpg</a>)</p><h2 id="3-Life-Cycle-of-a-Thread-in-Java"><a href="#3-Life-Cycle-of-a-Thread-in-Java" class="headerlink" title="3. Life Cycle of a Thread in Java"></a><strong>3. Life Cycle of a Thread in Java</strong></h2><p>The <em>java.lang.Thread</em> class contains a <em>static State enum –</em> which defines its potential states. During any given point of time, the thread can only be in one of these states:</p><ol><li>*<strong>NEW –</strong> a newly created thread that has not yet started the execution</li><li>*<strong>RUNNABLE –</strong> either running or ready for execution but it&#39;s waiting for resource allocation</li><li>*<strong>BLOCKED –</strong> waiting to acquire a monitor lock to enter or re-enter a synchronized block/method</li><li>*<strong>WAITING –</strong> waiting for some other thread to perform a particular action without any time limit</li><li>*<strong>TIMED_WAITING –</strong> waiting for some other thread to perform a specific action for a specified period</li><li>*<strong>TERMINATED –</strong> has completed its execution</li></ol><p>All these states are covered in the diagram above; let&#39;s now discuss each of these in detail.</p><h3 id="3-1-New"><a href="#3-1-New" class="headerlink" title="3.1. New"></a><strong>3.1. New</strong></h3><p><strong>A NEW Thread (or a Born Thread) is a thread that&#39;s been created but not yet started.</strong> It remains in this state until we start it using the <em>start()</em> method.</p><p>The following code snippet shows a newly created thread that&#39;s in the <em>NEW</em> state:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runnable runnable = <span class="keyword">new</span> NewState();</span><br><span class="line">Thread t = <span class="keyword">new</span> Thread(runnable);</span><br><span class="line">Log.info(t.getState());</span><br></pre></td></tr></table></figure><p>Since we&#39;ve not started the mentioned thread, the method <em>t.getState()</em> prints:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">NEW</span><br></pre></td></tr></table></figure><h3 id="3-2-Runnable"><a href="#3-2-Runnable" class="headerlink" title="3.2. Runnable"></a><strong>3.2. Runnable</strong></h3><p>When we&#39;ve created a new thread and called the <em>start()</em> method on that, it&#39;s moved from <em>NEW</em> to <em>RUNNABLE</em> state. <strong>Threads in this state are either running or ready to run, but they&#39;re waiting for resource allocation from the system.</strong></p><p>In a multi-threaded environment, the Thread-Scheduler (which is part of JVM) allocates a fixed amount of time to each thread. So it runs for a particular amount of time, then relinquishes the control to other <em>RUNNABLE</em> threads.</p><p>For example, let&#39;s add <em>t.start()</em> method to our previous code and try to access its current state:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Runnable runnable = <span class="keyword">new</span> NewState();</span><br><span class="line">Thread t = <span class="keyword">new</span> Thread(runnable);</span><br><span class="line">t.start();</span><br><span class="line">Log.info(t.getState());</span><br></pre></td></tr></table></figure><p>This code is <strong>most likely</strong> to return the output as:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RUNNABLE</span><br></pre></td></tr></table></figure><p>Note that in this example, it&#39;s not always guaranteed that by the time our control reaches <em>t.getState()</em>, it will be still in the <em>RUNNABLE</em> state.</p><p>It may happen that it was immediately scheduled by the <em>Thread-Scheduler</em> and may finish execution. In such cases, we may get a different output.</p><h3 id="3-3-Blocked"><a href="#3-3-Blocked" class="headerlink" title="3.3. Blocked"></a><strong>3.3. Blocked</strong></h3><p>A thread is in the <em>BLOCKED</em> state when it&#39;s currently not eligible to run. <strong>It enters this state when it is waiting for a monitor lock and is trying to access a section of code that is locked by some other thread.</strong></p><p>Let&#39;s try to reproduce this state:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BlockedState</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> DemoThreadB());</span><br><span class="line">        Thread t2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> DemoThreadB());</span><br><span class="line">        </span><br><span class="line">        t1.start();</span><br><span class="line">        t2.start();</span><br><span class="line">        </span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        </span><br><span class="line">        Log.info(t2.getState());</span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoThreadB</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        commonResource();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">commonResource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// Infinite loop to mimic heavy processing</span></span><br><span class="line">            <span class="comment">// &#x27;t1&#x27; won&#x27;t leave this method</span></span><br><span class="line">            <span class="comment">// when &#x27;t2&#x27; try to enter this</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>In this code:</p><ol><li>We&#39;ve created two different threads – <em>t1</em> and <em>t2</em></li><li><em>t1</em> starts and enters the synchronized <em>commonResource()</em> method; this means that only one thread can access it; all other subsequent threads that try to access this method will be blocked from the further execution until the current one will finish the processing</li><li>When <em>t1</em> enters this method, it is kept in an infinite while loop; this is just to imitate heavy processing so that all other threads cannot enter this method</li><li>Now when we start <em>t2</em>, it tries to enter the <em>commonResource()</em> method, which is already being accessed by <em>t1,</em> thus, <em>t2</em> will be kept in the <em>BLOCKED</em> state</li></ol><p>Being in this state, we call <em>t2.getState()</em> and get the output as:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BLOCKED</span><br></pre></td></tr></table></figure><h3 id="3-4-Waiting"><a href="#3-4-Waiting" class="headerlink" title="3.4. Waiting"></a><strong>3.4. Waiting</strong></h3><p><strong>A thread is in WAITING state when it&#39;s waiting for some other thread to perform a particular action.</strong> <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/9/docs/api/java/lang/Thread.State.html#WAITING">According to JavaDocs</a>, any thread can enter this state by calling any one of the following three methods:</p><ol><li><em>object.wait()</em></li><li><em>thread.join()</em> or</li><li><em>LockSupport.park()</em></li></ol><p>Note that in <em>wait()</em> and <em>join()</em> – we do not define any timeout period as that scenario is covered in the next section.</p><p>We have <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-wait-notify">a separate tutorial</a> that discusses in detail the use of <em>wait()</em>, <em>notify()</em> and <em>notifyAll()</em>.</p><p>For now, let&#39;s try to reproduce this state:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WaitingState</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Thread t1;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> WaitingState());</span><br><span class="line">        t1.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Thread t2 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> DemoThreadWS());</span><br><span class="line">        t2.start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            t2.join();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            Log.error(<span class="string">&quot;Thread interrupted&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoThreadWS</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            Log.error(<span class="string">&quot;Thread interrupted&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        Log.info(WaitingState.t1.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Let&#39;s discuss what we&#39;re doing here:</p><ol><li>We&#39;ve created and started the <em>t1</em></li><li><em>t1</em> creates a <em>t2</em> and starts it</li><li>While the processing of <em>t2</em> continues, we call <em>t2.join()</em>, this puts <em>t1</em> in <em>WAITING</em> state until <em>t2</em> has finished execution</li><li>Since <em>t1</em> is waiting for <em>t2</em> to complete, we&#39;re calling <em>t1.getState()</em> from <em>t2</em></li></ol><p>The output here is, as you&#39;d expect:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WAITING</span><br></pre></td></tr></table></figure><h3 id="3-5-Timed-Waiting"><a href="#3-5-Timed-Waiting" class="headerlink" title="3.5. Timed Waiting"></a><strong>3.5. Timed Waiting</strong></h3><p><strong>A thread is in TIMED_WAITING state when it&#39;s waiting for another thread to perform a particular action within a stipulated amount of time.</strong></p><p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/9/docs/api/java/lang/Thread.State.html#TIMED_WAITING">According to JavaDocs</a>, there are five ways to put a thread on <em>TIMED_WAITING</em> state:</p><ol><li><em>thread.sleep(long millis)</em></li><li><em>wait(int timeout)</em> or <em>wait(int timeout, int nanos)</em></li><li><em>thread.join(long</em> millis*)*</li><li><em>LockSupport.parkNanos</em></li><li><em>LockSupport.parkUntil</em></li></ol><p>To read more about the differences between <em>wait()</em> and <em>sleep()</em> in Java, have a look at <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-wait-and-sleep">this dedicated article here</a>.</p><p>For now, let&#39;s try to quickly reproduce this state:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimedWaitingState</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        DemoThread obj1 = <span class="keyword">new</span> DemoThread();</span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(obj1);</span><br><span class="line">        t1.start();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// The following sleep will give enough time for ThreadScheduler</span></span><br><span class="line">        <span class="comment">// to start processing of thread t1</span></span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        Log.info(t1.getState());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DemoThread</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            Thread.currentThread().interrupt();</span><br><span class="line">            Log.error(<span class="string">&quot;Thread interrupted&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Here, we&#39;ve created and started a thread <em>t1</em> which is entered into the sleep state with a timeout period of 5 seconds; the output will be:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TIMED_WAITING</span><br></pre></td></tr></table></figure><h3 id="3-6-Terminated"><a href="#3-6-Terminated" class="headerlink" title="3.6. Terminated"></a><strong>3.6. Terminated</strong></h3><p>This is the state of a dead thread. <strong>It&#39;s in the TERMINATED state when it has either finished execution or was terminated abnormally.</strong></p><p>We have <a target="_blank" rel="noopener" href="https://www.baeldung.com/java-thread-stop">a dedicated article</a> that discusses different ways of stopping the thread.</p><p>Let&#39;s try to achieve this state in the following example:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TerminatedState</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        Thread t1 = <span class="keyword">new</span> Thread(<span class="keyword">new</span> TerminatedState());</span><br><span class="line">        t1.start();</span><br><span class="line">        <span class="comment">// The following sleep method will give enough time for </span></span><br><span class="line">        <span class="comment">// thread t1 to complete</span></span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        Log.info(t1.getState());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// No processing in this block</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Here, while we&#39;ve started thread <em>t1</em>, the very next statement <em>Thread.sleep(1000)</em> gives enough time for <em>t1</em> to complete and so this program gives us the output as:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TERMINATED</span><br></pre></td></tr></table></figure><p>In addition to the thread state, we can check the <em><a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Thread.html#isAlive()">isAlive()</a></em> method to determine if the thread is alive or not. For instance, if we call the <em>isAlive()</em> method on this thread:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Assert.assertFalse(t1.isAlive());</span><br></pre></td></tr></table></figure><p>It returns <em>false.</em> Put simply, <strong>a thread is alive if and only if it has</strong> <strong>been started and has not yet died.</strong></p><h2 id="4-Conclusion"><a href="#4-Conclusion" class="headerlink" title="4. Conclusion"></a><strong>4. Conclusion</strong></h2><p>In this tutorial, we learned about the life-cycle of a thread in Java. We looked at all six states defined by <em>Thread.State</em> enum and reproduced them with quick examples.</p><p>Although the code snippets will give the same output in almost every machine, in some exceptional cases, we may get some different outputs as the exact behavior of Thread Scheduler cannot be determined.</p><p>And, as always, the code snippets used here are <a target="_blank" rel="noopener" href="https://github.com/eugenp/tutorials/tree/master/core-java-modules/core-java-concurrency-basic-2">available on GitHub</a>.</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang=""><link itemprop="mainEntityOfPage" href="http://xiaojianzheng.cn/2021/10/29/2021-10-30-Spring-Application-Context-Events/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="JIAHE"><meta itemprop="description" content="Collection & Reuse"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="JIAHE"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a href="/2021/10/29/2021-10-30-Spring-Application-Context-Events/" class="post-title-link" itemprop="url">Spring Application Context Events</a></h2><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-10-30 00:00:00" itemprop="dateCreated datePublished" datetime="2021-10-30T00:00:00+08:00">2021-10-30</time></span></div></div></header><div class="post-body" itemprop="articleBody"><div class="note info"><p>原文地址：<a target="_blank" rel="noopener" href="https://www.baeldung.com/spring-context-events">https://www.baeldung.com/spring-context-events</a></p></div><h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a><strong>1. Introduction</strong></h2><p>In this tutorial, we&#39;ll learn about the event support mechanism provided by the Spring framework. We&#39;ll explore the various built-in events provided by the framework and then see how to consume an event.</p><p>To learn about creating and publishing custom events, have a look at <a target="_blank" rel="noopener" href="https://www.baeldung.com/spring-events">our previous tutorial here.</a></p><p>Spring has an eventing mechanism which is built around the <em>ApplicationContext.</em> It can be used to <strong>exchange information between different beans.</strong> We can make use of application events by listening for events and executing custom code.</p><p>For example, a scenario here would be to execute custom logic on the complete startup of the <em>ApplicationContext</em>.</p><h2 id="2-Standard-Context-Events"><a href="#2-Standard-Context-Events" class="headerlink" title="2. Standard Context Events"></a><strong>2. Standard Context Events</strong></h2><p>In fact, there&#39;re a variety of built-in events in Spring, that <strong>lets a developer hook into the lifecycle of an application and the context</strong> and do some custom operation.</p><p>Even though we rarely use these events manually in an application, the framework uses it intensively within itself. Let&#39;s start by exploring various built-in events in Spring.</p><h3 id="2-1-ContextRefreshedEvent"><a href="#2-1-ContextRefreshedEvent" class="headerlink" title="2.1. ContextRefreshedEvent"></a><strong>2.1. ContextRefreshedEvent</strong></h3><p>On either <strong>initializing or refreshing the</strong> <em><strong>ApplicationContext</strong>,</em> Spring raises the <em>ContextRefreshedEvent</em>. Typically a refresh can get triggered multiple times as long as the context has not been closed.</p><p>Notice that, we can also have the event triggered manually by calling the <em>refresh()</em> method on the <em>ConfigurableApplicationContext</em> interface.</p><h3 id="2-2-ContextStartedEvent"><a href="#2-2-ContextStartedEvent" class="headerlink" title="2.2. ContextStartedEvent"></a><strong>2.2. ContextStartedEvent</strong></h3><p><strong>By calling the start() method</strong> on the <em>ConfigurableApplicationContext,</em> we trigger this event and start the <em>ApplicationContext</em>. As a matter of fact, the method is typically used to restart beans after an explicit stop. We can also use the method to deal components with no configuration for autostart.</p><p><strong>Here, it&#39;s important to note that the call to start() is always explicit as opposed to refresh().</strong></p><h3 id="2-3-ContextStoppedEvent"><a href="#2-3-ContextStoppedEvent" class="headerlink" title="2.3. ContextStoppedEvent"></a><strong>2.3. ContextStoppedEvent</strong></h3><p>A <em>ContextStoppedEvent</em> is published <strong>when the ApplicationContext is stopped</strong>, by invoking the <em>stop()</em> method on the <em>ConfigurableApplicationContext.</em> As discussed earlier, we can restart a stopped event by using <em>start()</em> method.</p><h3 id="2-4-ContextClosedEvent"><a href="#2-4-ContextClosedEvent" class="headerlink" title="2.4. ContextClosedEvent"></a><strong>2.4. ContextClosedEvent</strong></h3><p>This event is published <strong>when the ApplicationContext is closed</strong>, using the <em>close()</em> method in <em>ConfigurableApplicationContext</em>.<br>In reality, after closing a context, we cannot restart it.</p><p>A context reaches its end of life on closing it and hence we cannot restart it like in a <em>ContextStoppedEvent.</em></p><h2 id="3-Event-Listener"><a href="#3-Event-Listener" class="headerlink" title="3. @Event Listener"></a><strong>3. @Event Listener</strong></h2><p>Next, let us explore how to consume the published events. Starting from version 4.2, Spring supports an annotation-driven event listener – <em>@Event Listener.</em></p><p>In particular, we can make use of this annotation to <strong>automatically register an Application Listener based on the signature of the method</strong> :</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@EventListener</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleContextRefreshEvent</span><span class="params">(ContextStartedEvent ctxStartEvt)</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Context Start Event received.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Significantly, <strong>@Event Listener is a core annotation and hence doesn&#39;t need any extra configuration</strong>. In fact, the existing <em><a href="context:annotation-driven/">context:annotation-driven/</a></em> element provides full support to it.</p><p>A method annotated with <em>@Event Listener</em> can return a non-void type. If the value returned is non-null, the eventing mechanism will publish a new event for it.</p><h3 id="3-1-Listening-to-Multiple-Events"><a href="#3-1-Listening-to-Multiple-Events" class="headerlink" title="3.1. Listening to Multiple Events"></a><strong>3.1. Listening to Multiple Events</strong></h3><p>Now, there might arise situations where we will need our listener to consume multiple events.</p><p>For such a scenario, we can make use of <a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/event/EventListener.html#classes">classes</a> attribute:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@EventListener(classes = &#123; ContextStartedEvent.class, ContextStoppedEvent.class &#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMultipleEvents</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;Multi-event listener invoked&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-Application-Event-Listener"><a href="#4-Application-Event-Listener" class="headerlink" title="4. Application Event Listener"></a><strong>4. Application Event Listener</strong></h2><p>If we&#39;re using earlier versions of Spring (&lt;4.2), we&#39;ll have to introduce a <a target="_blank" rel="noopener" href="https://www.baeldung.com/spring-events">custom <em>ApplicationEventListener</em> and override the method <em>onApplicationEvent</em></a> to listen to an event.</p><h2 id="5-Conclusion"><a href="#5-Conclusion" class="headerlink" title="5. Conclusion"></a><strong>5. Conclusion</strong></h2><p>In this article, we&#39;ve explored the various built-in events in Spring. In addition, we&#39;ve seen various ways to listen to the published events.</p><p>As always, the code snippets used in the article can be found <a target="_blank" rel="noopener" href="https://github.com/eugenp/tutorials/tree/master/spring-core">over on Github</a>.</p></div><footer class="post-footer"><div class="post-eof"></div></footer></article></div><nav class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a> <a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a></nav></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">湘ICP备19011756号-1</a></div><div class="copyright"> &copy; 2021 – <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">JIAHE</span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer><script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdn.jsdelivr.net/npm/pdfobject@2.2.7/pdfobject.min.js","integrity":"sha256-ph3Dk89VmuTVXG6x/RDzk53SU9LPdAh1tpv0UvnDZ2I="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/quicklink@2.2.0/dist/quicklink.umd.js" integrity="sha256-4kQf9z5ntdQrzsBC3YSHnEz02Z9C1UeW/E9OgnvlzSY=" crossorigin="anonymous"></script><script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"ignores":null,"url":"http://xiaojianzheng.cn/page/2/"}</script><script src="/js/third-party/quicklink.js"></script></body></html>