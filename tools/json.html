<!doctypehtml><meta charset=utf-8><title>Format/Compress</title><link href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/foldgutter.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/javascript/javascript.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/xml/xml.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/htmlmixed/htmlmixed.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/foldcode.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/foldgutter.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/brace-fold.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/xml-fold.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/indent-fold.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/markdown-fold.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/comment-fold.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify-html.min.js></script><script src=/tools/js/format.js></script><style>body, html {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    
    .toolbar {
      display: flex;
      align-items: center;
      padding: 1em;
      background-color: #f2f2f2;
    }
    
    .button {
      display: inline-block;
      padding: 0.5em 1em;
      margin-right: 0.5em;
      background-color: #2d9cdb;
      color: white;
      border-radius: 0.25em;
      font-size: 1em;
      cursor: pointer;
      transition: background-color 0.3s ease-out;
    }
    
    .button:hover {
      background-color: #2b8ac6;
    }
    
    label {
      margin-left: 0.5em;
      font-weight: bold;
    }
    
    select {
      margin-left: 0.5em;
      padding: 0.25em;
      font-size: 1em;
      border-radius: 0.25em;
      border: 1px solid #c4c4c4;
      outline: none;
      transition: border-color 0.3s ease-out;
    }
    
    select:focus {
      border-color: #2d9cdb;
    }
    
    .editor-wrapper {
      height: calc(100% - 4em);
      overflow: auto;
    }
    
    .CodeMirror {
      height: 100%;
    }</style><body><div class=toolbar><button class=button id=format-btn>Format</button><button class=button id=compress-btn>Compress</button><label for=tab-size>Tab Size:</label><select id=tab-size><option selected value=2>2<option value=4>4</select><label for=mode>Mode:</label><select id=mode><option value=javascript>JavaScript<option value=htmlmixed>HTML<option value=css>CSS<option value=xml>XML<option value=json>JSON</select></div><div class=editor-wrapper><textarea id=code></textarea></div><script>const editor = CodeMirror.fromTextArea(document.getElementById('code'), {
      mode: 'html',
      theme: 'default',
      lineNumbers: true,
      tabSize: 2,
      indentWithTabs: true,
      foldGutter: {
        rangeFinder: new CodeMirror.fold.combine(CodeMirror.fold.indent, CodeMirror.fold.comment)
      },
      gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
      foldOptions: {
        widget: "â€¦"
      }
    });

    const formatBtn = document.getElementById('format-btn');
    formatBtn.addEventListener('click', () => format(editor));

    const compressBtn = document.getElementById('compress-btn');
    compressBtn.addEventListener('click', () => compress(editor));

    const tabSizeSelect = document.getElementById('tab-size');
    tabSizeSelect.addEventListener('change', (e) => setTabSize(editor, e.target.value));

    const modeSelect = document.getElementById('mode');
    modeSelect.addEventListener('change', (e) => setMode(editor, e.target.value));

    function format(editor) {
      const value = editor.getValue();
      try {
        let formatted;
        let mode = editor.getOption('mode')
        console.log('mode', editor.getOption('mode'))
        if (mode === 'json') {
          formatted = JSON.stringify(JSON.parse(value), null, editor.getOption('tabSize'));
        } else if (mode === 'htmlmixed') {
          formatted = html_beautify(value, {
            indent_size: editor.getOption('tabSize')
          });
        } else if (mode === 'javascript') {
          formatted = js_beautify(value, {
            indent_size: editor.getOption('tabSize')
          });
        }
        editor.setValue(formatted);
      } catch (error) {
        console.error(error);
      }
    }

    function compress(editor) {
      const value = editor.getValue();
      try {
        let compressed;
        let mode = editor.getOption('mode')
        if (mode === 'json') {
          compressed = JSON.stringify(JSON.parse(value)).replace(/\s+/g, '');
        } else if (mode === 'htmlmixed') {
          compressed = new Packer().pack(value, 0, 0);
        } else if (mode === 'javascript') {
          compressed = js_beautify(value, {
            indent_size: 0
          }).replace(/\n/g, '').replace(/\s+/g, ' ');
        }
        editor.setValue(compressed);
      } catch (error) {
        console.error(error);
      }
    }


    function setTabSize(editor, size) {
      const tabSize = parseInt(size);
      editor.setOption('tabSize', tabSize);
    }

    function setMode(editor, mode) {
      editor.setOption('mode', mode);
    }

    // Resize editor to fill remaining height
    function resizeEditor() {
      const toolbarHeight = document.querySelector('.toolbar').offsetHeight;
      const windowHeight = window.innerHeight;
      const editorWrapper = document.querySelector('.editor-wrapper');
      editorWrapper.style.height = windowHeight - toolbarHeight + 'px';
      editor.refresh();
    }

    // Resize editor on window resize event
    window.addEventListener('resize', resizeEditor);

    // Initial resize of editor
    resizeEditor();</script>