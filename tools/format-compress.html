<!doctypehtml><meta charset=utf-8><title>Format/Compress</title><link href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/foldgutter.css rel=stylesheet><link href=/tools/css/format-compress.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.js></script><!-- 折叠 --><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/foldcode.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/indent-fold.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/comment-fold.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/foldgutter.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/brace-fold.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/xml-fold.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/fold/markdown-fold.js></script><!-- 语法高亮 --><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/javascript/javascript.min.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/xml/xml.min.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/css/css.min.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/yaml/yaml.min.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/htmlmixed/htmlmixed.min.js></script><!-- 复制 --><script src=https://cdn.staticfile.org/clipboard.js/2.0.4/clipboard.min.js></script><script src=/tools/js/format.js></script><script src=/tools/js/jquery.format.js></script><script src=/tools/js/ObjTree.js></script><script src=/tools/js/JKL.js></script><script src=/tools/js/beautify-css.min.js></script><script src=/tools/js/format-compress.js></script><body><div class=toolbar><button style="background-color: green" class=button id=copycode>复制代码</button><button class=button id=format-btn>格式化</button><button class=button id=compress-btn>压缩</button><span id=jsonTool> <button class=button id=json-xml-btn>JSON转XML</button> <button class=button id=xml-json-btn>XML转JSON</button> <button class=button id=json-csv-btn>JSON转CSV</button> <button class=button id=json-yaml-btn>JSON转YAML</button> </span><label for=tab-size>缩进:</label><select id=tab-size><option selected value=2>2<option value=4>4</select><label for=mode>Mode:</label><select id=mode><option value=json>JSON<option value=javascript>JavaScript<option value=htmlmixed>HTML<option value=css>CSS<option value=xml>XML<option value=java>JAVA</select></div><div class=editor-wrapper><textarea id=code></textarea></div><script>const editor = CodeMirror.fromTextArea(document.getElementById("code"), {
        mode: "javascript",
        theme: "default",
        lineNumbers: true,
        tabSize: 2,
        indentWithTabs: true,
        foldGutter: {
          rangeFinder: new CodeMirror.fold.combine(
            CodeMirror.fold.indent,
            CodeMirror.fold.comment
          ),
        },
        gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
        foldOptions: {
          widget: "…",
        },
        // 语法报错
        lint: true,
        //括号匹配
        matchBrackets: true,
      });
      CodeMirror.commands.autocomplete = function (cm) {
        cm.showHint({ hint: CodeMirror.hint.anyword });
      };

      new ClipboardJS("#copycode", {
        text: function (trigger) {
          return editor.getDoc().getValue();
        },
      })
        .on("success", function (e) {
          $("#copycode").text("已复制");
          editor.execCommand("selectAll");
          setTimeout(function () {
            $("#copycode").html('<i class="fa fa-copy"></i> 复制代码');
          }, 2000);
          e.clearSelection();
        })
        .on("error", function (e) {
          alert("Error!");
        });
      $("#format-btn").on("click", () => format(editor));
      $("#compress-btn").on("click", () => compress(editor));
      $("#xml-json-btn").on("click", () => xml2json(editor));
      $("#json-xml-btn").on("click", () => json2xml(editor));
      $("#json-csv-btn").on("click", () => json2csv(editor));
      $("#json-yaml-btn").on("click", () => json2yml(editor));
      $("#tab-size").on("change", (e) => setTabSize(editor, e.target.value));
      $("#mode").on("change", (e) => {
        let mode = e.target.value;
        if (e.target.value === "json") {
          $("#jsonTool").show();
          editor.setOption("mode", "javascript");
        } else {
          $("#jsonTool").hide();
        }
        setMode(editor, mode);
      });
      function setTabSize(editor, size) {
        const tabSize = parseInt(size);
        editor.setOption("tabSize", tabSize);
      }

      function setMode(editor, mode) {
        editor.setOption("mode", mode);
      }

      // Resize editor to fill remaining height
      function resizeEditor() {
        const toolbarHeight = document.querySelector(".toolbar").offsetHeight;
        const windowHeight = window.innerHeight;
        const editorWrapper = document.querySelector(".editor-wrapper");
        editorWrapper.style.height = windowHeight - toolbarHeight + "px";
        editor.refresh();
      }

      // Resize editor on window resize event
      window.addEventListener("resize", resizeEditor);

      // Initial resize of editor
      resizeEditor();</script><!-- 括号匹配 --><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/edit/matchbrackets.js></script><!-- 语法错误提示 --><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/lint/lint.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/addon/lint/json-lint.js></script><!-- 美化 --><script async src=https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify.min.js></script><script async src=https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify-html.min.js></script>