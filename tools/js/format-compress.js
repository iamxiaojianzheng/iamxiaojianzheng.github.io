function format(t){var a=t.getValue();if(a)try{let e;var r=t.getOption("mode"),n=t.getOption("tabSize");console.log("mode",t.getOption("mode")),r.endsWith("json")?e=JSON.stringify(JSON.parse(a),null,n):"htmlmixed"===r?e=html_beautify(a,{indent_size:n,indent_char:" "}):r.endsWith("javascript")?e=js_beautify(a,{indent_size:n,indent_char:" "}):r.endsWith("xml")?e=$.format(a,{method:"xml",step:n}):"css"===r?e=css_beautify(a,{indent_size:n,indent_char:" ",space_in_empty_paren:!0}):r.endsWith("sql")?e=sqlFormatter.format(a," ".repeat(n)):r.endsWith("java")?e=javaFormat(a,n):alert("do not support"),t.setValue(e)}catch(e){console.error(e)}}function compress(t){var a=t.getValue();if(a)try{let e=a;var r=t.getOption("mode");r.endsWith("json")?e=JSON.stringify(JSON.parse(a)).replace(/\s+/g,""):r.endsWith("htmlmixed")?e=(new Packer).pack(a,0,0):r.endsWith("javascript")?e=js_beautify(a,{indent_size:0}).replace(/\n/g,"").replace(/\s+/g," "):r.endsWith("xml")?e=$.format(a,{method:"xmlmin"}):r.endsWith("css")?e=$.format(a,{method:"cssmin"}):r.endsWith("sql")?e=$.format(a,{method:"sqlmin"}):r.endsWith("java")?e=a.replace(/\n/g,"").replace(/\s+/g," "):alert("do not support"),t.setValue(e)}catch(e){console.error(e)}}function json2xml(e){var t=e.getValue();if(t)try{var a=JSON.parse(t),r=decodeSpecialCharacter((new XML.ObjTree).writeXML(a));formatXML=$.format(r,{method:"xml"}),setMode(e,"application/xml"),e.setValue(formatXML)}catch(e){$("#warning").html('<div class="alert alert-danger">JSON 数据错误：'+e+"</div>").show().delay(5e3).fadeOut()}}function xml2json(e){if(e.getValue())try{var t=new XML.ObjTree,a=new JKL.Dumper,r=e.getValue(),n=t.parseXML(r);setMode(e,"application/ld+json"),e.setValue(a.dump(n))}catch(e){$("#warning").html('<div class="alert alert-danger">JSON 数据错误：'+e+"</div>").show().delay(5e3).fadeOut()}}function json2csv(e){var t=e.getValue();if(t){data=JSON.parse(t),arr=[],flag=!0;var a="",r="",n=!0;try{var s=typeof data;data=processJSON("object"!=s?$.parseJSON(data):data)}catch(e){return setMessage("error","Error in Convert : add proper input format"),!1}$.each(data,function(e,t){e%2==0?n&&("end"!=t?a+=t+",":(a=a.substring(0,a.length-1),n=!1)):"end"!=t?(e=data[e-1],-1!=a.search(e)&&(r+=t+",")):(r=r.substring(0,r.length-1),r+="\n")}),e.setValue(a+"\n"+r)}}function processJSON(e){return $.each(e,function(e,t){"object"==typeof t?(flag=!1,processJSON(t),arr.push("end"),arr.push("end")):arr.push(e,t)}),arr}var spacing=" ";function json2yml(e){let t=e.getValue();if(t)try{"string"==typeof t&&(t=JSON.parse(t));var a=[];convert(t,a),yaml=a.join("\n"),setMode(e,"text/x-yaml"),e.setValue(yaml)}catch(e){$("#warning").html('<div class="alert alert-danger">JSON 数据错误：'+e+"</div>").show().delay(5e3).fadeOut()}}function getType(e){var t=typeof e;return e instanceof Array?"array":"string"==t?"string":"boolean"==t?"boolean":"number"==t?"number":"undefined"==t||null===e?"null":"hash"}function convertHash(e,t){for(var a in e){var r=[];if(e.hasOwnProperty(a)){var n=e[a],n=(convert(n,r),getType(n));if("string"==n||"null"==n||"number"==n||"boolean"==n)t.push(normalizeString(a)+": "+r[0]);else{t.push(normalizeString(a)+": ");for(var s=0;s<r.length;s++)t.push(spacing+r[s])}}}}function convertArray(e,t){for(var a=0;a<e.length;a++){var r=[];convert(e[a],r);for(var n=0;n<r.length;n++)t.push((0==n?"- \n   ":spacing)+r[n])}}function convertString(e,t){t.push(normalizeString(e))}function normalizeString(e){return e.match(/^[\w]+$/)?e:JSON.stringify(e)}function convert(e,t){switch(getType(e)){case"array":convertArray(e,t);break;case"hash":convertHash(e,t);break;case"string":convertString(e,t);break;case"null":t.push("null");break;case"number":t.push(e.toString());break;case"boolean":t.push(e?"true":"false")}}function decodeSpecialCharacter(e){return e.replace(/\&amp;/g,"&").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&quot;/g,'"')}